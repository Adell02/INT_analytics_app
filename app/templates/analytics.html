{% extends 'template.html' %}

{% block title %} Analytics {% endblock %}
{% block head%} 
<link rel="stylesheet" href="../static/css/analytics.css">
{% endblock %}

{% block content %} 

<div class="margen"></div>
<div class="recuadro-superior-analytics">
    <button class="go-left" onclick="moveLeft()">
        <i class="fa fa-arrow-left fa-2x icono-boton-options" aria-hidden="true"></i>
    </button>
    <div class="graphic-type-analytics">
        <select id="graph_type" name="graph_type" placeholder="Select Graph Type:">
            <option value="none">Select Graph Type:</option>
            <option value="pie">Pie Chart</option>
            <option value="barchart">Bar Chart</option>
            <option value="histogram">Histogram / Distribution</option>
            <option value="scatter">Scatter Plot</option>
            <option value="linechart">Line Chart</option>
          </select>
    </div>
    <div class="graphic-title-analytics">
        <input type="text" class="new-graphic-input-analytics" id="userInput" name="userInput" placeholder="Enter Graph Title" value="">
    </div>
    <div class="graphic-data-analytics">
        <select name="graph_data_x" id="graph_data_x">
            <option value="none">Select Graph Data:</option>
            {% for column in columns_list %}
                <option value="{{ column }}">{{ column }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="contenedorfilter-analytics">      
        <button type="submit" id="filter-button" class="filter-button-analytics">Filter</button>
    </div>



    <button class="go-right" onclick="moveRight()">
        <i class="fa fa-arrow-right fa-2x icono-boton-options" aria-hidden="true"></i>
    </button>
</div>
<div class="recuadro-inferior-analytics">
    <div class="recuadro-inferior-analytics-top">
        <div class="graph-container recuadro-w50"></div>
        <div class="graph-container recuadro-w50"></div>
    </div>
    <div class="recuadro-inferior-analytics-bottom">
        <div class="graph-container recuadro-w50"></div>
        <div class="graph-container recuadro-w50"></div>
    </div>
</div>

<script>
     
    const plot = {{ plots | tojson | safe }};
    var plotFiltrado=[...plot];
    const containers = document.getElementsByClassName("graph-container");
    var graph_divs = [];
    let pageIndex = 0;

    document.getElementById('filter-button').addEventListener('click', filtrarPlot);


    // Funci칩n para cargar las gr치ficas
    function load_page() {
        // Carga las gr치ficas al cargar la p치gina
        create_all();
        window.onload = load_4;
        window.addEventListener('resize',resize_4);
    } 

    function moveRight() {
        if (plotFiltrado.length>(pageIndex+1)*4)
        {
            pageIndex++;
            load_4();
        }
        console.log(pageIndex);

        //updatePage();
    }

    function moveLeft() {
        if (pageIndex > 0) {
            pageIndex--;
            load_4();
            //updatePage();
        
        }console.log(pageIndex);
    }

    function updatePage() {
        const pageWidth = containers.length * containers[0].offsetWidth;
        const offset = -pageIndex * pageWidth;
        document.querySelector(".recuadro-inferior-analytics").style.transform = `translateX(${offset}px)`;
        
    }

    load_page();
    
</script>

{% endblock %}
